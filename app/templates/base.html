<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>OutStaff</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/tailwind.css') }}" />
  </head>
  <body class="min-h-screen">
    <header class="border-b border-slate-100 bg-white/90 backdrop-blur sticky top-0 z-30">
      <div class="mx-auto max-w-6xl px-4 py-3 flex items-center justify-between">
        <a href="{{ url_for('orgs.list_orgs') if current_user.is_authenticated else url_for('auth.login') }}" class="flex items-center gap-2">
          <span class="h-10 w-10 rounded-xl bg-brand-100 border border-brand-200 flex items-center justify-center text-brand-700 font-bold">OS</span>
          <div class="leading-tight">
            <p class="font-semibold text-slate-900">OutStaff</p>
            <p class="text-xs text-slate-500">Business management</p>
          </div>
        </a>
        <nav class="flex items-center gap-4">
          {% if current_user.is_authenticated %}
          <a class="nav-link" href="{{ url_for('orgs.list_orgs') }}">Organizations</a>
          <a class="nav-link" href="{{ url_for('certificates.list_certificates', org_id=(active_membership.org_id if active_membership else (user_orgs[0].id if user_orgs else 0))) if user_orgs else '#' }}">Certificates</a>
          <a class="nav-link" href="{{ url_for('time.dashboard', org_id=(active_membership.org_id if active_membership else (user_orgs[0].id if user_orgs else 0))) if user_orgs else '#' }}">Time</a>
          <div class="flex items-center gap-2">
            <span class="pill">{{ current_user.name }}</span>
            <a class="btn btn-secondary" href="{{ url_for('auth.logout') }}">Logout</a>
          </div>
          {% else %}
          <a class="btn btn-secondary" href="{{ url_for('auth.login') }}">Sign in</a>
          <a class="btn btn-primary" href="{{ url_for('auth.signup') }}">Create account</a>
          {% endif %}
        </nav>
      </div>
    </header>

    <main class="mx-auto max-w-6xl px-4 py-8">
      {% with messages = get_flashed_messages(with_categories=true) %}
      {% if messages %}
      <div class="space-y-2 mb-6">
        {% for category, message in messages %}
        <div data-flash class="card px-4 py-3 flex items-center justify-between border-l-4 {% if category=='success' %}border-brand-400{% elif category=='warning' %}border-amber-400{% elif category=='danger' %}border-rose-400{% else %}border-slate-200{% endif %}">
          <p class="text-sm text-slate-700">{{ message }}</p>
        </div>
        {% endfor %}
      </div>
      {% endif %}
      {% endwith %}

      {% block content %}{% endblock %}
    </main>
    <script src="{{ url_for('static', filename='js/main.js') }}"></script>
  </body>
</html>
