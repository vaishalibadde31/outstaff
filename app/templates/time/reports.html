{% extends "base.html" %}
{% block content %}
<div class="space-y-6">
  <div class="flex items-center justify-between">
    <div>
      <p class="text-sm uppercase tracking-wide text-brand-700 font-semibold">Reports</p>
      <h1 class="text-3xl font-bold">{{ org.name }}</h1>
      <p class="text-slate-600">Filter by dates, projects, users, and status. Export-ready data.</p>
    </div>
    <a class="btn btn-secondary" href="{{ url_for('time.dashboard', org_id=org.id) }}">Dashboard</a>
  </div>

  <div class="card p-6 space-y-4">
    <form method="POST" class="grid grid-cols-1 md:grid-cols-5 gap-4 items-end">
      {{ form.hidden_tag() }}
      <div class="space-y-2">
        {{ form.start_date.label }}
        {{ form.start_date(class_="w-full") }}
      </div>
      <div class="space-y-2">
        {{ form.end_date.label }}
        {{ form.end_date(class_="w-full") }}
      </div>
      <div class="space-y-2">
        {{ form.project_id.label }}
        {{ form.project_id(class_="w-full") }}
      </div>
      <div class="space-y-2">
        {{ form.user_id.label }}
        {{ form.user_id(class_="w-full") }}
      </div>
      <div class="space-y-2">
        {{ form.status.label }}
        {{ form.status(class_="w-full") }}
      </div>
      <div class="md:col-span-5">
        <button class="btn btn-primary" type="submit">{{ form.submit.label.text }}</button>
      </div>
    </form>

    <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
      <div class="card p-4">
        <p class="text-sm text-slate-600">Total hours</p>
        <p class="text-2xl font-bold text-slate-900">{{ (total_minutes/60)|round(2) }}h</p>
      </div>
      <div class="card p-4">
        <p class="text-sm text-slate-600">Billable hours</p>
        <p class="text-2xl font-bold text-brand-700">{{ (billable_minutes/60)|round(2) }}h</p>
      </div>
      <div class="card p-4">
        <p class="text-sm text-slate-600">Entries</p>
        <p class="text-2xl font-bold text-slate-900">{{ entries|length }}</p>
      </div>
    </div>

    <div class="space-y-3">
      {% for entry in entries %}
      <div class="border border-slate-100 rounded-xl px-4 py-3 flex items-center justify-between">
        <div>
          <p class="font-semibold text-slate-900">{{ entry.user.name }} • {{ entry.project.name if entry.project else 'General' }}</p>
          <p class="text-sm text-slate-600">{{ entry.date }} • {{ entry.start_at.strftime('%H:%M') }} → {{ entry.end_at.strftime('%H:%M') }} • {{ (entry.duration_minutes/60)|round(2) }}h</p>
          <p class="text-xs text-slate-500">Status: {{ entry.status.value }} • Billable: {{ 'Yes' if entry.billable else 'No' }}</p>
        </div>
        <span class="badge">{{ entry.status.value|capitalize }}</span>
      </div>
      {% else %}
      <p class="text-slate-600">No entries for these filters.</p>
      {% endfor %}
    </div>
  </div>
</div>
{% endblock %}
